;PROFILE 1 uses random top-m, follows everything

breed [profiles1 profile1]
breed [profiles2 profile2]

profiles1-own [max-m max-k topk-memory]
profiles2-own [max-m max-k topk-memory]

to profiles-setup [active-turtle m k tag-count tag-list]
  turtles-layout ;Standard layout
  set score 0
  set turns 0
  set max-m m
  set max-k k
  set document? false
  set active? true
  set tags n-of tag-count tag-list
  set topk-memory []
end

to profiles1-go [active-turtle]
  let topk topk-random active-turtle ([max-k] of active-turtle)  
  let like-list (like-tag active-turtle topk)
  ask active-turtle [set score score + score-new active-turtle topk like-list]
  ask active-turtle [create-like-links-to turtle-set like-list] 
end

to profiles2-go [active-turtle]
  ask active-turtle [
    let topk topk-peerSimilarity active-turtle ([max-k] of active-turtle)
    foreach topk [if not member? ? topk-memory [set topk-memory lput ? topk-memory]]
    let like-list (like-tag active-turtle topk)
    set score score + score-new active-turtle topk like-list
    
    let topm (topm-docShared active-turtle max-m)
    let follows (follow-everything active-turtle topm) 
    
    create-like-links-to turtle-set like-list
    create-follow-links-to turtle-set follows
  ]
end